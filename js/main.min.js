toggled=new Array();searchCode="";$(document).ready(function(){var a=false;libs=$(".library");for(i=0;i<libs.length;i++){libs[i].id=i.toString()}libs.click(function(b){if(toggled[this.id]){this.querySelector(".l-settings").style.transform="";this.nextElementSibling.style.height="0px";content.style.margin="0px"}else{this.querySelector(".l-settings").style.transform="rotate(180deg)";content=this.nextElementSibling;content.style.height="";height=content.clientHeight;content.style.height="0px";setTimeout(function(){content.style.height=height.toString()+"px";content.style.margin="0px"},10)}toggled[this.id]=!toggled[this.id]});$(".l-drop").click(function(b){openOptions(this.parentElement.id);b.stopPropagation()});$(".h-more").click(function(b){openOptions(this.parentElement.id);b.stopPropagation()});$("#imp-bg-fade").click(function(){$(".l-sett-opt").css({opacity:"0",right:"50px"});$("#imp-message, #imp-bg-fade").css("opacity","0");setTimeout(function(){$("#imp-message, #imp-bg-fade, .l-sett-opt").css("display","none")},100);closeSettings();closeTagSearch();closeStats();closeAddLib();closeAccount();closePost();closeBalance()});$(".expand-sidenav").click(function(){if(!a){expandSidenav()}else{compactSidenav()}a=!a});$(".openSettings").click(function(){openSettings();$("#imp-bg-fade").css("opacity","")});$(".closeSettings").click(function(){closeSettings();$("#imp-message, #imp-bg-fade").css("opacity","0")});$(".openTagSearch").click(function(){openTagSearch();tagSearch("");$("#imp-bg-fade").css("opacity","")});$(".closeTagSearch").click(function(){closeTagSearch();$("#imp-message, #imp-bg-fade").css("opacity","0")});$(".openStats").click(function(){openStats();$("#imp-bg-fade").css("opacity","")});$(".closeStats").click(function(){closeStats();$("#imp-message, #imp-bg-fade").css("opacity","0")});$(".openAddLib").click(function(){openAddLib();$("#imp-bg-fade").css("opacity","")});$(".closeAddLib").click(function(){closeAddLib();$("#imp-message, #imp-bg-fade").css("opacity","0")});$(".openAccount").click(function(){openAccount();$("#imp-bg-fade").css("opacity","")});$(".closeAccount").click(function(){closeAccount();$("#imp-message, #imp-bg-fade").css("opacity","0")});$(".openPost").click(function(){openPost();$("#imp-bg-fade").css("opacity","")});$(".closePost").click(function(){closePost();$("#imp-message, #imp-bg-fade").css("opacity","0")});$(".openBalance").click(function(){openBalance();$("#imp-bg-fade").css("opacity","")});$(".closeBalance").click(function(){closeBalance();$("#imp-message, #imp-bg-fade").css("opacity","0")});$(".openEcSearch").click(function(){openBalance();$("#imp-bg-fade").css("opacity","")});$(".closeEcSearch").click(function(){closeBalance();$("#imp-message, #imp-bg-fade").css("opacity","0")});$(".s-tab").click(function(){if(!(this.classList.contains("s-selected"))){$(".s-tab").toggleClass("s-selected");$(".s-c-wrapper").toggleClass("s-slide")}});$(".t-cross").click(function(){var b=this.parentElement;sendCommand("delete_favorite",null,{type:this.dataset.type},function(c){b.parentNode.removeChild(b)})});$(".c-title-holder .searchbar input").keyup(function(){tagSearch(this.value)});$(".sendAddLib").click(function(){var d=$("#libForm").serializeArray();console.log(d);var b=new Array();for(var c=0;c<d.length;c++){dataP=d[c];b[dataP.name]=dataP.value}d=b;if(!("private" in d)){d["private"]=0}else{d["private"]=1}sendCommand("create_library",null,d,function(e){console.log(e)})})});function tagSearch(a){searchCode=uuid();sendCommand("search_tag",null,{code:searchCode,q:a},function(c){console.log(c);if(searchCode==c.code){$(".c-b-wrapper").text("");for(var d=0;d<c.results;d++){var b=c.tags[d];$(".c-b-wrapper").append('<div class="c-result" onclick="addTag(\''+b+'\')"><h1 class="c-r-title">'+b+'</h1><div class="type c">+</div></div>')}}})}function addTag(a){sendCommand("add_favorite",null,{type:a},function(b){console.log(b.favorites)})}function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var b=Math.random()*16|0,a=d=="x"?b:(b&3|8);return a.toString(16)})}function sendCommand(a,f,d,h){if(f==null){var j=document.cookie.split("; ");for(i=0;i<j.length;i++){var b=j[i];if(b.startsWith("PHPSESSID")){f=b.split("=")[1];break}}}var e="";for(var g in d){if(d.hasOwnProperty(g)){e+=g+"="+d[g]+"&"}}e+="session="+f;var c=new XMLHttpRequest();c.onreadystatechange=function(){if(this.readyState==4&&this.status==200){response=JSON.parse(this.responseText);if(response.status=="success"){h(response)}}};c.open("POST","/api/"+a,true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send(e)}function uploadFile(c,d,e,f,g,h){if(d==null){var j=document.cookie.split("; ");for(i=0;i<j.length;i++){var a=j[i];if(a.startsWith("PHPSESSID")){d=a.split("=")[1];break}}}var b=new FormData();b.append("file",c);b.append("type",e);b.append("parent",f);b.append("library",g);b.append("session",d);$.ajax({type:"POST",url:"/api/create_post",contentType:false,processData:false,data:b,success:function(k){k=JSON.parse(k);if(k.status=="success"){h(k)}}})}function followAction(){var a=document.getElementById("follow-btn");if(a.className=="follow"||a.className=="unfollow"){sendCommand(a.className,null,{handle:a.dataset.handle},function(b){if(b.following){a.className="unfollow"}else{a.className="follow"}a.innerHTML="<span>"+b.followers+"</span>"})}}function openOptions(b){console.log(b);var a=$("#"+b).offset();$(".l-sett-opt").css({top:(a.top+15)+"px",opacity:"0",right:"50px",display:""});$("#imp-bg-fade").css("display","");setTimeout(function(){$(".l-sett-opt").css({opacity:"",right:""});$("#imp-bg-fade").css("opacity","")},10)}function showError(a){elmt=$("#imp-bg-fade, #imp-message");elmt.css("display","");setTimeout(function(){elmt.css("opacity","")},10);$("#imp-message .imp-p").text(a)}function openSettings(){$(".s-settings").css({display:"table"});$("#imp-bg-fade").css("display","");setTimeout(function(){$(".l-sett-opt").css({opacity:"",right:""});$("#imp-bg-fade").css("opacity","")},10)}function closeSettings(){$(".s-settings").css({display:"none"});$("#imp-bg-fade").css("display","none")}function openTagSearch(){$(".tagFinder").css({display:"block"});$("#imp-bg-fade").css("display","");setTimeout(function(){$(".l-sett-opt").css({opacity:"",right:""});$("#imp-bg-fade").css("opacity","")},10)}function closeTagSearch(){$(".tagFinder").css({display:"none"});$("#imp-bg-fade").css("display","none")}function openStats(){$(".stats").css({display:"block"});$("#imp-bg-fade").css("display","");setTimeout(function(){$(".l-sett-opt").css({opacity:"",right:""});$("#imp-bg-fade").css("opacity","")},10)}function closeStats(){$(".stats").css({display:"none"});$("#imp-bg-fade").css("display","none")}function openAddLib(){$(".addLib").css({display:"block"});$("#imp-bg-fade").css("display","");setTimeout(function(){$(".l-sett-opt").css({opacity:"",right:""});$("#imp-bg-fade").css("opacity","")},10)}function closeAddLib(){$(".addLib").css({display:"none"});$("#imp-bg-fade").css("display","none")}function openAccount(){$(".s-dropdown").css({display:"block"});$("#imp-bg-fade").css("display","");setTimeout(function(){$(".l-sett-opt").css({opacity:"",right:""});$("#imp-bg-fade").css("opacity","")},10);$(".peep").children().css("filter","blur(5px)");$(".s-dropdown").css("filter","blur(0px)");$(".peep").css("background","#222")}function closeAccount(){$(".s-dropdown").css({display:"none"});$("#imp-bg-fade").css("display","none");$(".peep").children().css("filter","blur(0px)");$(".peep").css("background","#fff")}function openPost(){window.scrollTo(0,0);$(".m-post").css({display:"block"});$("#imp-bg-fade").css("display","");setTimeout(function(){$(".l-sett-opt").css({opacity:"",right:""});$("#imp-bg-fade").css("opacity","")},10)}function closePost(){$(".m-post").css({display:"none"});$("#imp-bg-fade").css("display","none")}function openBalance(){$(".balance-message").css({display:"block"});$("#imp-bg-fade").css("display","");setTimeout(function(){$(".l-sett-opt").css({opacity:"",right:""});$("#imp-bg-fade").css("opacity","")},10);$(".peep").children().css("filter","blur(5px)");$(".balance-message").css("filter","blur(0px)");$(".peep").css("background","#222")}function closeBalance(){$(".balance-message").css({display:"none"});$("#imp-bg-fade").css("display","none");$(".peep").children().css("filter","blur(0px)");$(".peep").css("background","#fff")}function expandSidenav(){$(".sidenav-home").css({width:"950px"});$(".home-content").css({width:"auto","margin-left":"950px"});$(".home-logo").css({"margin-bottom":"0px"});$(".searchbar").css({display:"none"});$(".expand-sidenav").css({transform:"rotate(-30deg)"});$(".exp-post-corridor").css({display:"inline-block"});$(".tl-post-title").css({display:"inline-block"});setTimeout(function(){$(".exp-post-corridor").css({display:"inline-block"});setTimeout(function(){$(".exp-post-corridor").css({opacity:"1"})},10)},100);setTimeout(function(){$(".tl-post-title").css({display:"inline-block"});setTimeout(function(){$(".tl-post-title").css({opacity:"1"})},10)},100)}function compactSidenav(){$(".sidenav-home").css({width:"300px"});$(".home-content").css({width:"auto","margin-left":"300px"});$(".home-logo").css({"margin-bottom":"80px"});$(".searchbar").css({display:"block"});$(".expand-sidenav").css({transform:"rotate(30deg)"});$(".exp-post-corridor").css({display:"none"});setTimeout(function(){$(".exp-post-corridor").css({display:"none",opacity:"0"})},10);$(".tl-post-title").css({opacity:"0"});setTimeout(function(){$(".tl-post-title").css({display:"none"})},10)}function removeDragData(a){if(a.dataTransfer.items){a.dataTransfer.items.clear()}else{a.dataTransfer.clearData()}}function libDrop(b){b.preventDefault();var a=b.dataTransfer.files[0];var c=a.name.split(".");uploadFile(a,null,c[c.length-1],-1,b.srcElement.dataset.id,function(d){console.log(d)});removeDragData(b);$(b.srcElement).removeClass("is-dragover")}function libDrag(a){a.preventDefault();$(a.srcElement).addClass("is-dragover")}function libDragLeave(a){a.preventDefault();$(a.srcElement).removeClass("is-dragover")};